<form class="action">

    <div class="header">
        <img class="actor" src="{{actor.img}}"/>
        <span class="sentence">{{sentence}}</span>
        <img class="target" src="{{img}}"/>
    </div>

    <div class="body">

        <div class="roll">

            <div class="parameters">

                <div class="type">
                {{#if opposed}}
                    <label>{{localize 'NEPH5E.jetOpposition'}}</label>
                {{else}}
                    {{#switch type}}
                    {{#case 'none'}}
                    <select id="rollType" name="rollType">
                        <option value="simple">{{localize 'NEPH5E.jetSimple'}}</option>
                        <option value="opposed">{{localize 'NEPH5E.jetOppose'}}</option>
                    </select>
                    {{/case}}
                    {{#case 'simple'}}
                    <select id="rollType" name="rollType" disabled>
                        <option value="simple">{{localize 'NEPH5E.jetSimple'}}</option>
                    </select>
                    {{/case}}
                    {{#case 'opposed'}}
                    <select id="rollType" name="rollType" disabled>
                        <option value="opposed">{{localize 'NEPH5E.jetOppose'}}</option>
                    </select>
                    {{/case}}
                    {{/switch}}
                {{/if}}
                </div>

                {{#if (or (eq item.system.element 'choix') (eq element 'choix'))}}
                <select id="element" name="element">
                    <option value='air'>{{localize "NEPH5E.air"}}</option>
                    <option value='eau'>{{localize 'NEPH5E.eau'}}</option>
                    <option value='feu'>{{localize 'NEPH5E.feu'}}</option>
                    <option value='lune'>{{localize 'NEPH5E.lune'}}</option>
                    <option value='terre'>{{localize 'NEPH5E.terre'}}</option>
                </select>
                {{/if}}

                {{#if (eq item.system.elements.[0] 'quintuple')}}
                <select id="element" name="element">
                    {{#if (gt actor.system.alchimie.primae.air.quantite 4)}}
                    <option value='air'>{{localize "NEPH5E.air"}}</option>
                    {{/if}}
                    {{#if (gt actor.system.alchimie.primae.eau.quantite 4)}}
                    <option value='eau'>{{localize 'NEPH5E.eau'}}</option>
                    {{/if}}
                    {{#if (gt actor.system.alchimie.primae.feu.quantite 4)}}
                    <option value='feu'>{{localize 'NEPH5E.feu'}}</option>
                    {{/if}}
                    {{#if (gt actor.system.alchimie.primae.lune.quantite 4)}}
                    <option value='lune'>{{localize 'NEPH5E.lune'}}</option>
                    {{/if}}
                    {{#if (gt actor.system.alchimie.primae.terre.quantite 4)}}
                    <option value='terre'>{{localize 'NEPH5E.terre'}}</option>
                    {{/if}}
                </select>
                {{/if}}

            </div>

            <div class="dice">
                <a id="roll"><i class="fas fa-dice-d20"></i></a>
                <label id="difficulty">{{difficulty}}%</label>
            </div>

        </div>

        <div class="lines">

            <div class="line">
                <div class="line-title">
                    <label>{{base.name}}</label>
                </div>
                <div class="line-value">
                    <label id="base">{{base.difficulty}}</label>
                    <label class="base-percentage">%</label>
                </div>
            </div>

            {{#if opposed}}

                <div class="line">
                    <div class="line-title">
                        <label>Modificateur</label>
                    </div>
                    <div class="line-value">
                        <input id="modifier" type="Number" value="0"/>
                        <label class="percentage base-percentage">%</label>
                    </div>
                </div>

            {{else}}

                {{#if (eq (getSystemOption 'modifierPolicy') 'clavier')}}
                <div class="line">
                    <div class="line-title">
                        <label>Modificateur</label>
                    </div>
                    <div class="line-value">
                        <input id="modifier" type="Number" value="0"/>
                        <label class="percentage base-percentage">%</label>
                    </div>
                </div>
                {{/if}}

                {{#if (eq (getSystemOption 'modifierPolicy') 'liste')}}
                <div class="line">
                    <div class="line-title">
                        <label>Modificateur</label>
                    </div>
                    <div class="line-value">
                        <select id="modifier">
                            {{#if (eq (getSystemOption 'modifierRange') '100')}}
                            <option value="100">100%</option>
                            <option value="90">90%</option>
                            <option value="80">80%</option>
                            <option value="70">70%</option>
                            <option value="60">60%</option>
                            {{/if}}
                            <option value="50">50%</option>
                            <option value="40">40%</option>
                            <option value="30">30%</option>
                            <option value="20">20%</option>
                            <option value="10">10%</option>
                            <option value="0" selected>0%</option>
                            <option value="-10">-10%</option>
                            <option value="-20">-20%</option>
                            <option value="-30">-30%</option>
                            <option value="-40">-40%</option>
                            <option value="-50">-50%</option>
                            {{#if (eq (getSystemOption 'modifierRange') '100')}}
                            <option value="-60">-60%</option>
                            <option value="-70">-70%</option>
                            <option value="-80">-80%</option>
                            <option value="-90">-90%</option>
                            <option value="-100">-100%</option>
                            {{/if}}
                        </select>
                    </div>
                </div>
                {{/if}}

                {{#if (eq (getSystemOption 'modifierPolicy') 'slider')}}
                <div class="line">
                    <div class="line-title">
                        <label>Modificateur</label>
                        {{#if (eq (getSystemOption 'modifierRange') '50')}}
                        <input id="modifier" class="slider" type="range" min="-50" max="50" step="10" value="0"/>
                        {{else}}
                        <input id="modifier" class="slider" type="range" min="-100" max="100" step="10" value="0"/>
                        {{/if}}
                    </div>
                    <div class="line-value">
                        <label id="sliderModifier">0</label>
                        <label class="base-percentage">%</label>
                    </div>
                </div>
                {{/if}}

            {{/if}}

            {{#unless opposed}}

            {{#unless (eq fraternite 0)}}
            <div class="line">
                <div class="line-title">
                    <select id="fraternite" name="fraternite">
                        <option value="ignore">{{localize 'NEPH5E.ignorerFraternite'}}</option>
                        <option value="apply">{{localize 'NEPH5E.appliquerFraternite'}}</option>
                    </select>
                </div>
                <div class="line-value">
                    <label id="fraterniteModifier">0</label>
                    <label class="base-percentage">%</label>
                </div>
            </div>
            {{/unless}}

            {{#unless (eq blessures 0)}}
            <div class="line">
                <div class="line-title">
                    <select id="blessures" name="blessures">
                        <option value="apply">{{localize 'NEPH5E.appliquerBlessures'}}</option>
                        <option value="ignore">{{localize 'NEPH5E.ignorerBlessures'}}</option>
                    </select>
                </div>
                <div class="line-value">
                    <label id="blessuresModifier">{{blessures}}</label>
                    <label class="base-percentage">%</label>
                </div>
            </div>
            {{/unless}}

            {{#if (nonNull approches)}}
            <div class="line">
                <div class="line-title">
                    <select id="approche" name="approche">
                        {{#each approches as |approche|}}
                        <option value="{{approche.name}}">{{approche.label}}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="line-value">
                    <label id="approcheModifier">0</label>
                    <label class="base-percentage">%</label>
                </div>
            </div>
            {{/if}}

            {{#if (nonNull metamorphe)}}
            <div class="line">
                <div class="line-title">
                    <select id="metamorphe" name="metamorphe">
                        <option value="ignore">{{localize 'NEPH5E.ignorerMetamorphe'}}</option>
                        <option value="apply">{{localize 'NEPH5E.appliquerMetamorphe'}}</option>
                    </select>
                </div>
                <div class="line-value">
                    <label id="metamorpheModifier">0</label>
                    <label class="base-percentage">%</label>
                </div>
            </div>
            {{/if}}

            {{#if (nonNull mnemos)}}

            <div class="block">
                <label>Effets Mnémos</label>
            </div>

            {{#each mnemos as |m|}}
            <div class="line">
                <div class="line-title">
                    <label>{{m.name}}</label>
                </div>
                <div class="line-value">
                    <select class="mnemos-modifier">
                        <option value="{{m.degre}}">{{m.degre}}0%</option>
                        <option value="0" selected>0%</option>
                    </select>
                </div>
            </div>
            {{/each}}
            {{/if}}

            {{/unless}}

        </div>
    
    </div>

</form>